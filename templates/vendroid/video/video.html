{% extends "vendroid/base.html" %}
{% load pagination_tags %}
{% load url from future %}
{% load static %}
{% load humanize %}
{% block header_tags %}
{% endblock header_tags %}
{% block content %}

    <script src="{% static "js/jquery.js" %}"></script>
    <script src='//static.opentok.com/v2/js/opentok.min.js'></script>
    {#      <meta name="author" content="SitePoint">#}
    {#  <script src="{% static "js/rtccint.js" %}"></script>#}
    {#  <script src="{% static "js/Rtcc.js" %}"></script>#}
    {#  <script src="https://raw.githubusercontent.com/sightcall/rtcc-integration/master/src/rtccint.js"></script>#}

    <link rel="stylesheet" type="text/css" href="{% static "css/sightcall.css" %}">
    <div class="vd_body">
        <!-- Header Start -->
{#        {% include "vendroid/partial/_header.html" %}#}
        <!-- Header Ends -->
        <div class="content">
            <div class="container">
{#                {% include "vendroid/partial/_sidebar.html" %}#}
{#                {% include "vendroid/video/_video_users.html" %}#}
                <!-- Middle Content Start -->

                <div class="vd_content-wrapper">
                    <div class="">
                        <div class="vd_content clearfix">
{#                            <div class="vd_title-section clearfix">#}
{#                                <div class="vd_panel-header no-subtitle">#}
{#                                    <br/>#}
{##}
{#                                    <h1 class="pull-left">YapJoy Connect</h1>#}
{##}
{#                                </div>#}
{#                            </div>#}
                            <!-- row -->
                            <div class="col-md-12">

                                <div class="col-md-12" style="margin-top: 15px;">
                                    <h3>Live Video Chat</h3>

                                    <div id='subscribersDiv' height="300px">
                                        {% if not token and not session_id %}
                                        <img src="{% static "images/video-chat.png" %}"/>{% else %}Waiting for the user to connect / accept the video call.{% endif %}
                                    </div>
                                    <div class="clearfix"></div>
                                </div>
                                <div class="col-md-12">
                                    <br/>
{##}
{#                                    <h3><span style="float: left;">{{ user.get_full_name }} <span#}
{#                                            class="badge status vd_bg-green">&nbsp;</span> |</span>#}
{##}
{#                                        <form method="post"><input hidden id="create_session" name="create_session"/>#}
{#                                            <button type="submit" class="btn btn btn-success" style="font-size: 15px;">#}
{#                                                Create a session#}
{#                                            </button>#}
{#                                        </form>#}
{#                                    </h3>#}
                                    {% if session_id and token %}
    {#                                        <div>#}
    {#                                            <h4 style="color: green;">Video call</h4>#}
    {#                                            Use the following link to share the session with your friends:<br/>#}
    {#                                            Link: <input#}
    {#                                                value="https://{{ request.META.HTTP_HOST }}/video/?session_id={{ session_id }}&token={{ token }}"/>#}
    {##}
    {#                                            <div class="clearfix"></div>#}
    {#                                        </div>#}
                                    {% endif %}
                                    <div id='myPublisherDiv' class="pull-right" width="70%" height="70%"></div>
                                    <div>
                                        <p>YapJoy now have video chat feature, to connect with love ones and explain
                                            thousands of vendors inside YapJoy.</p>

{#                                        <h2>Invite users to initiate video chat.</h2>#}
{##}
{#                                        <p>In case of calling vendors, Vendors will be charged for each call that can#}
{#                                            last for 1 Hour (60 minutes) at most.</p>#}
                                    </div>
                                </div>

                                {% if session_id and token %}
                                    <script src='//static..com/v2/js/opentok.min.js'></script>
                                    <script>
                                        var apiKey = '45497542';
                                        var sessionId = '{{ session_id }}';
                                        var token = '{{ token }}';
                                        var session = OT.initSession(apiKey, sessionId);
                                        session.on({
                                            streamCreated: function (event) {
                                                session.subscribe(event.stream, 'subscribersDiv', {insertMode: 'append'});
                                            }
                                        });
                                        session.connect(token, function (error) {
                                            if (error) {
                                                console.log(error.message);
                                            } else {
                                                session.publish('myPublisherDiv', {width: 170, height: 120});
                                            }
                                        });
                                    </script>
                                {% endif %}
                            </div>


                        </div>
                        <!-- .vd_content-section -->

                    </div>
                    <!-- .vd_content -->
                </div>
                <!-- .vd_container -->
            </div>
            <!-- .vd_content-wrapper -->

            <!-- Middle Content End -->

        </div>
        <!-- .container -->

        <!-- .content -->

{#        <!-- Footer Start -->#}
{#        <footer class="footer-1" id="footer">#}
{#            <div class="vd_bottom ">#}
{#                <div class="container">#}
{#                    <div class="row">#}
{#                        <div class=" col-xs-12">#}
{#                            <div class="copyright">#}
{#                                Copyright &copy;2015 YapJoy Inc. All Rights Reserved#}
{#                            </div>#}
{#                        </div>#}
{#                    </div>#}
{#                    <!-- row -->#}
{#                </div>#}
{#                <!-- container -->#}
{#            </div>#}
{#        </footer>#}
        <!-- Footer END -->

{#        <div class="vd_chat-menu hidden-xs" style="margin-right: 125px;">#}
{#            <div class="vd_mega-menu-wrapper">#}
{#                <div class="vd_mega-menu">#}
{#                    <ul class="mega-ul">#}
{#                        <li class="one-big-icon mega-li">#}
{#                            <a href="#" class="mega-link open" data-action="click-trigger">#}
{#                                <span class="mega-icon">#}
{#                                    <img alt="example image"#}
{#                                                             src="{{ request.user.userprofile.get_image_url }}">#}
{#                                </span>#}
{#                            </a>#}
{##}
{#                            <div style="display: block;"#}
{#                                 class="vd_mega-menu-content  open-top width-xs-4 width-md-5 width-lg-4 center-xs-4"#}
{#                                 data-action="click-target">#}
{##}
{#                                <div class="child-menu">#}
{#                                    <div class="title">#}
{#                                           Group Chat <i>(online)</i>#}
{#                                           <div class="vd_panel-menu pull-right">#}
{#                                                 <div data-rel="tooltip" data-original-title="Video Call" class="menu">#}
{#                                                    <i class="fa fa-video-camera"></i>#}
{#                                                </div>#}
{#                                                 <div data-rel="tooltip" data-original-title="Close" class="menu entypo-icon">#}
{#                                                    <i class="icon-cross"></i>#}
{#                                                </div>#}
{#                                            </div>#}
{#                                       </div>#}
{#                                    <div class="clearfix"></div>#}
{#                                    <div class="content-list content-image content-menu">#}
{#                                        <div style="overflow: hidden;" class="mCustomScrollbar _mCS_12"#}
{#                                             data-rel="scroll">#}
{#                                            <div class="closing chat-area">#}
{#                                                <iframe class="iframe_class" style="width: 100%; height: 330px"#}
{#                                                        src="http://{{ request.META.HTTP_HOST }}/chat/room/1/"/>#}
{#                                            </div>#}
{#                                        </div>#}
{#                                    </div>#}
{#                                    <!-- child-menu -->#}
{#                                </div>#}
{#                            </div>#}
{#                            <!-- vd_mega-menu-content -->#}
{#                        </li>#}
{#                    </ul>#}
{#                    <!-- Head menu search form ends -->#}
{#                </div>#}
{#            </div>#}
{#        </div>#}
{#        <div class="clearfix"></div>#}
    </div>

{% endblock content %}
{% block script %}
    <script type="text/javascript" src='{% static "vendroid/plugins/sparkline/jquery.sparkline.min.js" %}'></script>



{% endblock script %}